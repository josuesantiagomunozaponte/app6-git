YUI.add("flickr-photosets-delete-deletor",function(e,t){"use strict";function n(n,r){return n.photoset_id=n.setID,n.gpCode&&(n.gp_code=n.gpCode),n.gpOwner&&(n.gp_owner=n.gpOwner),n.shareCode&&(n.share_code=n.shareCode),r.callAPI("flickr.photosets.delete",n).then(function(e){if(e.code===1)throw new Error(e)}).catch(e.FetcherErrorLogger(t))}e.namespace("ModelDeletors")["flickr-photosets-delete-deletor"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photosets-getPhotos-fetcher",function(e,t){"use strict";function r(t){t.page=t.page||1,t.perPage=t.perPage||100;var r={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:t.perPage,page:t.page,get_user_info:1,primary_photo_extras:"url_c, url_h, url_k, url_l, url_m, url_n, url_o, url_q, url_s, url_sq, url_t, url_z, needs_interstitial, can_share",jump_to:t.withPhotoId||""};return t.gpCode&&t.gpCode!==null?(r.gp_code=t.gpCode,r.share_code=t.gpCode,r.gp_owner=t.gpOwner,n.info("Calling sets api with GP "+t.gpCode)):r.photoset_id=t.id.split("-")[0],t.includeHiddenSets&&(r.extras+=",hidden_sets",r.user_id=t.userId),t.viewAs&&(r.view_as=t.viewAs),t.filter&&(r.privacy_filter=t.filter),r}function i(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l,c,h,p,d,v=[],m=!1,g=!1,y=n.id;l=e.APIHelper.response.parsePerson(r.user),c=s.addOrUpdate(l),h={id:n.id,title:r.photoset.title,description:r.photoset.description,owner:c,primary:r.photoset.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(r.photoset),isAutoUploadSet:r.photoset.isAutoUploadSet,isSharedEntity:r.photoset.hidden&&r.photoset.hidden===1,photoCount:r.photoset.photoCount,videoCount:r.photoset.videoCount,publicPhotosCount:r.photoset.countPhotosPublic,primaryNeedsInterstitial:r.photoset.needsInterstitial,totalCount:parseInt(r.photoset.photoCount,10)+parseInt(r.photoset.videoCount,10),photoList:[],viewCount:r.photoset.countViews,canShare:r.photoset.canShare+(r.photoset.canShareDeep||0),canDownload:r.photoset.canDownload},y&&y!==r.photoset.id&&(h.id=y),r.photoset.isAutoUploadSet==="1"&&(h.canShare=!1),o.exists(n.id)&&(p=o.getValue(n.id,"photoPageList"),m=p.hasMinBoundary?p.hasMinBoundary():!1,g=p.hasMaxBoundary?p.hasMaxBoundary():!1,v=p.getList()),d=e.APIHelper.response.parsePhotos({photos:r.photoset.photo,ownerID:r.photoset.owner,personModelRegistry:s,photoModelRegistry:i,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),h.photoPageList=e.APIHelper.response.addOrReplaceListByPage({current:v,perPage:n.perPage,pageNum:n.page,hasMax:g,hasMin:m,totalItems:r.photoset.total,newPages:d}),h.photoPageList={perPage:r.photoset.perPage,page:r.photoset.page,pageContent:d,totalItems:r.photoset.total},h.photoList.length&&(h.primary=r.photoset.primary);var b={id:h.id,countPhotosFamily:r.photoset.countPhotosFamily,countPhotosFriend:r.photoset.countPhotosFriend,countPhotosPublic:r.photoset.countPhotosPublic,countPhotosFriendFamily:r.photoset.countPhotosFriendFamily,totalCount:r.photoset.countPhotosAll};return f.exists(b.id)?f.setValues(n.id,b):f.add(b),o.exists(h.id)?o.setValue(n.id,"photoPageList",h.photoPageList):o.add(h),d}function s(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.photosets.getPhotos",this._processParams(n),!0),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("set-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("album-privacy-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}var n=require("lib/flog")(t);e.namespace("ListFetchers")["flickr-photosets-getPhotos"]={run:s,_processParams:r,_processResponse:i}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","set-models","photo-engagement-models","photo-stats-models"]});
YUI.add("flickr-photosets-getContext-fetcher",function(e,t){"use strict";function n(t,n){var r={extras:e.APIHelper.request.getRebootPhotoExtras(),photo_id:t.photoId,num_prev:t.numNext,num_next:t.numPrev,get_photoset_info:1};return t.gpCode?(r.share_code=t.gpCode,r.share_owner=t.gpOwner,r.gp_code=t.gpCode,r.gp_owner=t.gpOwner):r.photoset_id=t.id,r}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=[],l=[],c=s.proxy(n.photoId),h,p,d,v,m,g,y=[];return h=r.prevphotos,p=r.nextphotos,l=e.APIHelper.response.parsePhotos({photos:h.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),f=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),m=i.getValue(n.id,"photoContextList"),d=m.hasMinBoundary?m.hasMinBoundary():!1,v=m.hasMaxBoundary?m.hasMaxBoundary():!1,g=m.getList(),y=e.APIHelper.response.addOrReplaceListByContext({model:c,next:l,prev:f.reverse(),current:g,hasMin:d,hasMax:v,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",y),{next:l,previous:f.reverse()}}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.photosets.getContext",this._processParams(n,r),!0),r.getModelRegistry("set-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models")]).then(function(e){return i._processResponse(e,n)},function(e){throw e.code===2&&e.message==="Photo not in set"&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photosets-getContext"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","photo-engagement-models","photo-stats-models"]});
YUI.add("flickr-photosets-create-creator",function(e,t){"use strict";function n(n,r){var i={},s=[];return i.title=n.title,i.description=n.description,i.primary_photo_id=n.photoID,i.full_result=1,s=[r.callAPI("flickr.photosets.create",i),r.getModelRegistry("set-models"),r.getModel("person-models",r.getViewer().nsid),r.getModel("sets-models",r.getViewer().nsid,{page:1,perPage:r.flipper.isFlipped("enable-sets-list-loading-fix")?10:500}),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-contexts-models")],n.isMultiplePhotos||s.push(r.getModel("photo-models",n.photoID)),e.Promise.all(s).then(function(t){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f,l,c,h,p,d=1;return r.photoset.id?(n.isMultiplePhotos?n.numberOfPhotosSelected+n.numberOfVideosSelected===1?(h=r.photoset.photos,p=r.photoset.videos):r.photoset.photos?(h=r.photoset.photos,p=0):(p=r.photoset.videos,h=0):(l=t[6],h=r.photoset.photos,p=r.photoset.videos),f={id:r.photoset.id,title:r.photoset.title.content,photoPageList:n.isMultiplePhotos?[]:[l],photoContextList:n.isMultiplePhotos?[]:[l],owner:s,primary:r.photoset.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(r.photoset),isAutoUploadSet:!1,photoCount:h,videoCount:p,totalCount:d,viewCount:r.countViews||0},i.add(f),c=i.proxy(r.photoset.id),o.getValue("albumsList").unshift(c),u.exists(n.photoID)&&!u.getValue(n.photoID,"sets").getFromListByID(c.getValue("id"))&&(u.getValue(n.photoID,"sets").prependToList(c),u.setValue(n.photoID,"total",u.getValue(n.photoID,"total")+1)),a.exists(n.photoID)&&!a.getValue(n.photoID,"contexts").getFromListByID(c.getValue("id"))&&(a.setValue(n.photoID,"totalSets",a.getValue(n.photoID,"totalSets")+1),a.getValue(n.photoID,"contexts").appendToList(c)),c):!1},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-create"]={run:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","sets-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-createHidden-creator",function(e,t){"use strict";function n(n,r){var i={},s=[];return i.photo_ids=n.photoIds,s=[r.callAPI("flickr.photosets.createHidden",i),r.getModelRegistry("set-models"),r.getModel("person-models",r.getViewer().nsid)],e.Promise.all(s).then(function(e){var t=e[0],n=e[1],r=e[2],i,s;return t.stat==="ok"&&t.photoset.share_code?(i={id:t.photoset.share_code,shareCode:t.photoset.share_code,owner:r,gpCode:t.photoset.share_code,gpOwner:r.getValue("pathAlias")||r.getValue("nsid"),url:t.photoset.url,isAutoUploadSet:!1,isSharedEntity:!0,totalCount:t.photoset.count},n.add(i),s=n.proxy(i.id),s):!1},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-createHidden"]={run:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","sets-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-editMeta-updater",function(e,t){"use strict";function r(e,t,r){var i=e[0],s=e[1];if(!i.photoset||!i.photoset.title||!i.photoset.description)n.warn("No updated data returned from API.");else{if(!s.exists(t.photosetId))throw new Error("[flickr-photosets-editMeta-updater] - Set model cannot be updated if it does not exist");s.setValues(t.photosetId,{title:i.photoset.title.content,description:i.photoset.description.content})}}function i(n,r){var i={},s=this;return i.photoset_id=n.photosetId,i.title=n.title,i.description=n.description,e.Promise.all([r.callAPI("flickr.photosets.editMeta",i),r.getModelRegistry("set-models")]).then(function(e){s._processResponse(e,n,r)},e.FetcherErrorLogger(t))}var n=require("lib/flog")(t);e.namespace("ModelUpdaters")["flickr-photosets-editMeta"]={run:i,_processResponse:r}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photosets-setPrimaryPhoto-updater",function(e,t){"use strict";function n(n,r){var i={};return i.photoset_id=n.albumId,i.photo_id=n.photoId,r.callAPI("flickr.photosets.setPrimaryPhoto",i).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-photosets-setPrimaryPhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("set-models",function(e,t){function r(e){r.superclass.constructor.call(this,e)}var n=require("lib/flog")(t);e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photosets-getPhotos"].run(t,this.appContext)},create:function(t,n){return e.ModelCreators["flickr-photosets-create"].run(t,n)},createHidden:function(t,n){return e.ModelCreators["flickr-photosets-createHidden"].run(t,n)},addPhoto:function(t,n){return e.ModelCreators["flickr-photosets-addPhoto"].run(t,n)},removePhoto:function(t,n){return e.ModelCreators["flickr-photosets-removePhoto"].run(t,n)},update:function(t,n){return e.ModelUpdaters["flickr-photosets-editMeta"].run({photosetId:t,title:n.title?n.title.newVal:this.getValue(t,"title"),description:n.description?n.description.newVal:this.getValue(t,"description")},this.appContext)},setPrimaryPhoto:function(t,n){return e.ModelUpdaters["flickr-photosets-setPrimaryPhoto"].run(t,n)},"delete":function(t){if(typeof t=="string"){var n=t;t={setID:n}}return e.ModelDeletors["flickr-photosets-delete-deletor"].run(t,this.appContext)}},addPhoto:function(e,t){return this.getValue(e,"photoPageList").hasMaxBoundary()&&this.getValue(e,"photoPageList").appendToList(t),this.getValue(e,"photoContextList").hasMaxBoundary()&&this.getValue(e,"photoContextList").appendToList(t),this},removePhoto:function(e,t){return this.getValue(e,"photoPageList").removeFromList(t.getValue("id")),this.getValue(e,"photoContextList").removeFromList(t.getValue("id")),this},hasPhoto:function(e,t){return this.getValue(e,"photoPageList").getFromListByID(t)||this.getValue(e,"photoContextList").getFromListByID(t)},getSizeToFit:function(t,r,i){n.warn("Using `getSizeToFit` is deprecated. See model comments for more details.");var s=e.PhotoModelHelper.getSizeToFit(t,r,e.merge({sizes:this.getValue(t,"primaryPhotoSizes"),includeSquare:!0,cropToFit:!0},i));return s&&(s.url=s.src),s},getLargestPrimaryPhotoSize:function(t,n){return e.PhotoModelHelper.getLargestSize(t,n)},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"set"}},title:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},description:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photosets-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-photosets-getContext"],listItemIdField:"photoId"}},photoCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},videoCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},publicPhotosCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},totalCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return this.getValue(e,"photoCount")+this.getValue(e,"videoCount")}},viewCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},photoCountDisplay:{readOnly:!0,derivedBy:["totalCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),n=this.getValue(e,"videoCount"),r=this.getValue(e,"totalCount"),i="";return t-=n,t===0&&n===0?i=this.intlMessage({intlName:"models.ZERO_PHOTOS"}):t===1&&n===0?i=this.intlMessage({intlName:"models.ONE_PHOTO"}):t>1&&n===0?i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS",photos:t}):t===0&&n===1?i=this.intlMessage({intlName:"models.ONE_VIDEO"}):t===1&&n===1?i=this.intlMessage({intlName:"models.ONE_PHOTO_AND_ONE_VIDEO"}):t>1&&n===1?i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_ONE_VIDEO",photos:t}):t===0&&n>1?i=this.intlMessage({intlName:"models.MULTIPLE_VIDEOS",videos:n}):t===1&&n>1?i=this.intlMessage({intlName:"models.ONE_PHOTO_AND_MULTIPLE_VIDEOS",videos:n}):t>1&&n>1&&(i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS",photos:t,videos:n})),r===0?i=this.intlMessage({intlName:"models.ZERO_ITEMS"}):r===1?i=this.intlMessage({intlName:"models.ONE_ITEM"}):r>1&&(i=this.intlMessage({intlName:"models.MULTIPLE_ITEMS",items:r})),i}},photoAndVideosDisplay:{readOnly:!0,derivedBy:["photoCount","videoCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),n=this.getValue(e,"videoCount"),r="";return t===0&&n===0?r=this.intlMessage({intlName:"models.ZERO_PHOTOS"}):t===1&&n===0?r=this.intlMessage({intlName:"models.ONE_PHOTO"}):t>1&&n===0?r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS",photos:t}):t===0&&n===1?r=this.intlMessage({intlName:"models.ONE_VIDEO"}):t===1&&n===1?r=this.intlMessage({intlName:"models.ONE_PHOTO_AND_ONE_VIDEO"}):t>1&&n===1?r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_ONE_VIDEO",photos:t}):t===0&&n>1?r=this.intlMessage({intlName:"models.MULTIPLE_VIDEOS",videos:n}):t===1&&n>1?r=this.intlMessage({intlName:"models.ONE_PHOTO_AND_MULTIPLE_VIDEOS",videos:n}):t>1&&n>1&&(r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS",photos:t,videos:n})),r}},sharedEntityDisplay:{readOnly:!0,derivedBy:["videoCount","photoCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),n=this.getValue(e,"videoCount"),r=this.getValue(e,"owner"),i="";return t&&!n?i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_PHOTOS_ONLY",username:r.getValue("displayname"),photoCount:parseInt(t,10)}):!t&&n?i=this.intlMessage({intlName
:"shared-entity.USERNAME_HAS_SHARED_VIDEOS_ONLY",username:r.getValue("displayname"),videoCount:parseInt(n,10)}):t&&n&&(i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_PHOTOS_VIDEOS",username:r.getValue("displayname"),photoCount:parseInt(t,10),videoCount:parseInt(n,10)})),i}},primary:{},primaryPhotoSizes:{},primaryNeedsInterstitial:{},bestIconURL:{readOnly:!0,derivedBy:["primaryPhotoSizes"],defaultFn:function(t){var n=e.PhotoModelHelper.getSizeToFit(t,{height:48,width:48},e.merge({sizes:this.getValue(t,"primaryPhotoSizes"),includeSquare:!0,cropToFit:!0}));return n?n.src:""}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),n=this.getValue(e,"isSharedEntity"),r=this.getValue(e,"normalizedId");return t&&n===!0?"/photos/"+t.getValue("pathAlias")+"/shares/"+r:t?"/photos/"+t.getValue("pathAlias")+"/albums/"+r:undefined}},isAutoUploadSet:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isSharedEntity:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canShare:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},canDownload:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},urlSuffix:{readOnly:!0,defaultFn:function(e){var t=this.getValue(e,"isSharedEntity");return t?"shares-"+e:"album-"+e}},gpCode:{defaultFn:function(e){return null}},gpOwner:{defaultFn:function(e){return null}}}},{buildCompoundId:function(e,t,n){var r=e;return t&&(r+="-"+t),n&&(t||(r+="-dateposted"),r+="-"+n),r},splitCompoundId:function(e){var t=e.split("-");return{nsid:t[0],orderBy:t[1],viewAs:t[2]}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photosets-addPhoto-creator","flickr-photosets-removePhoto-deletor","flickr-photosets-delete-deletor","flickr-photosets-getPhotos-fetcher","flickr-photosets-getContext-fetcher","flickr-photosets-create-creator","flickr-photosets-createHidden-creator","flickr-photosets-editMeta-updater","flickr-photosets-setPrimaryPhoto-updater","photo-model-helper"],langBundles:["models","shared-entity"]});
YUI.add("photo-groups-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext)}},attributes:{id:{},groups:{isCollection:!0},total:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getAllContexts-fetcher"]});
YUI.add("flickr-photos-getAllContexts-fetcher",function(e,t){"use strict";function n(t){var n;return n={photo_id:t.id,extras:e.APIHelper.request.getRebootPhotoExtras()+","+e.APIHelper.request.getRebootGroupExtras()+","+e.APIHelper.request.getRebootAlbumsListExtras(),primary_photo_extras:"url_sq, url_t, url_s, url_m, needs_interstitial"},t.scrappy&&(n.get_all_galleries=1,n.no_faves_context=1,n.per_type_limit=6,n.get_totals=1,n.sort="date-desc"),n}function r(t,n){var r=t[0],i=t[1],s=t[2],o={},u=[],a,f=t[8],l=t[9],c=t[10],h=t[11],p;return o.faves=t[3],o.gallery=t[4],o.pool=t[5],o.set=t[6],o.stream=t[7],e.Object.each(o,function(t,n){r[n]&&e.Array.each(r[n],function(n){e.APIHelper.response.addContextToRegistry(n,t,i,h),u.push(t.proxy(n.id))})}),s.exists(n.id)||(a=s.add({id:n.id,totalGroups:r.totals&&r.totals.groups,totalSets:r.totals&&r.totals.sets,totalGalleries:r.totals&&r.totals.galleries}),s.setValue(n.id,"contexts",u)),f.addOrUpdate({id:n.id,total:r.totals&&r.totals.groups,groups:s.getContextsOfType(n.id,"group-pool-models")}),p=s.getContextsOfType(n.id,"set-models"),p.forEach(function(e){e.setValue("totalCount",parseInt(e.getValue("photoCount"),10)+parseInt(e.getValue("videoCount"),10))}),l.addOrUpdate({id:n.id,total:r.totals&&r.totals.sets,sets:p}),c.addOrUpdate({id:n.id,total:r.totals&&r.totals.galleries,galleries:s.getContextsOfType(n.id,"gallery-models")}),a}function i(n,r){var i=this;return r.flipper.isFlipped("enable-scrappy-photo-page")&&(n.scrappy=!0),e.Promise.all([r.callAPI("flickr.photos.getAllContexts",this._processParams(n),!0),r.getModelRegistry("person-models"),r.getModelRegistry("photo-contexts-models"),r.getModelRegistry("favorite-models"),r.getModelRegistry("gallery-models"),r.getModelRegistry("group-pool-models"),r.getModelRegistry("set-models"),r.getModelRegistry("photostream-models"),r.getModelRegistry("photo-groups-models"),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-galleries-models"),r.getModelRegistry("group-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-photos-getAllContexts"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-contexts-models","favorite-models","gallery-models","group-pool-models","photostream-models","set-models","photo-groups-models","photo-sets-models","photo-galleries-models","group-models"]});
YUI.add("photo-contexts-models",function(e){function t(e){t.superclass.constructor.call(this,e),this.getMorePromises={"group-pool-models":{},"set-models":{},"gallery-models":{}},this.continuationKeys={"group-pool-models":{},"set-models":{},"gallery-models":{}}}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return this.appContext.flipper.isFlipped("enable-scrappy-photo-page")?e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext):e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)}},getMoreContextsOfType:function(t,n,r){var i=this,s,o,u,a,f,l,c,h="-1",p=e.APIHelper.request.getRebootPhotoExtras();switch(n){case"group-pool-models":s="flickr.photos.getGroups",u="groups.group",p+=","+e.APIHelper.request.getRebootGroupExtras();break;case"set-models":s="flickr.photos.getSets",u="sets.set";break;case"gallery-models":s="flickr.photos.getGalleries",u="galleries.gallery"}return s?this.exists(t)?(a=this.continuationKeys[n][t]||"0",a===h?e.Promise.resolve({type:n,newContexts:[],loadedAll:!0}):(o={photo_id:t,extras:p,primary_photo_extras:"url_sq, url_t, url_s, url_m",continuation:a,per_page:r},l=t+"_"+a,c=this.getMorePromises[n][l],c?c:(this.getMorePromises[n][l]=(new e.FlickrPromise({apiResponse:this.appContext.callAPI(s,o,!0),contextRegistry:this.appContext.getModelRegistry(n),personRegistry:this.appContext.getModelRegistry("person-models")})).then(function(r){var s=[],o=r.apiResponse,a=r.contextRegistry,c=r.personRegistry,p,d,v;return d=u.split(".").reduce(function(t,n){return e.Lang.isObject(t)?t[n]:undefined},o),d&&(e.Array.each(d,function(t){e.APIHelper.response.addContextToRegistry(t,a,c),s.push(a.proxy(t.id))}),s.length&&(v=i.getContextsOfType(t,n).map(function(e){return e.getValue("id")}),s=s.filter(function(e){return v.indexOf(e.getValue("id"))===-1}),s.length&&i.getValue(t,"contexts").appendToListMulti(s))),f=o.continuation,typeof f=="undefined"?f=h:e.Lang.isNumber(f)&&(f+=""),p=f===h,i.continuationKeys[n][t]=f,delete i.getMorePromises[n][l],{type:n,newContexts:s,loadedAll:p}}),this.getMorePromises[n][l]))):e.Promise.reject("[photo-contexts-models] getMoreContextsOfType was called for an ID that isn't in the registry: "+t):e.Promise.reject("[photo-contexts-models] getMoreContextsOfType was called without an invalid type: "+n)},getContextsOfType:function(t,n){return n=e.Array(n),this.getValue(t,"contexts").getList().filter(function(e){return n.indexOf(e.registry.name)>-1})},getContextsNotOfType:function(t,n){return n=e.Array(n),this.getValue(t,"contexts").getList().filter(function(e){return n.indexOf(e.registry.name)===-1})},attributes:{contexts:{isCollection:!0},totalGroups:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},totalSets:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},totalGalleries:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","flickr-photos-getAllContexts-fetcher"]});
YUI.add("vr-overlay-view",function(e,t){var n=require("lib/flog")(t),r;r={css:{destinationContainer:"body",closeX:".close"},options:{}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.nsid=e.nsid,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.immersed=!1,this},subviewConfig:{},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){return e.set("photo",t),e.canVr().then(function(t){e.set("canVr",t)})})},buildContainer:function(){var e=this.get("canVr");return this.set("isActiveViewAgnostic",!0),e?(this.setContainerWithTemplate("vr-overlay"),this):this},buildErrorContainer:function(){this.setContainerHTML("")},activate:function(){var t=this;if(!this.get("canVr"))return;return this.loadFlickvr().then(function(){var n=t.get("container");n.addClass("active"),n.one(r.css.closeX)&&t.registerEventHandler(n.one(r.css.closeX).on("click",e.bind(t.closeVr,t))),t.registerEventHandler(t.get("container").on("click",t.openVr,t)),t.isMobile||t.openVr()}).then(null,function(e){n.error("Failed to load flickvr from CDN",{err:e})}),this},loadFlickvr:function(){return new e.Promise(function(t,r){if(window.Flickvr)return t();e.Get.js("https://s.yimg.com/uy/flickvr/version.js",function(i){if(i)return r();if(!window.FlickvrVersion)return r();e.Get.js("https://s.yimg.com/uy/flickvr/"+window.FlickvrVersion+".js",function(e){return e?r():(n.log("flickvr loaded successfully from CDN"),t())})})})},hasEquirectangularTag:function(){return this.appContext.getModel("photo-tags-models",this.photoId).then(function(e){var t=!1,n=e.toJSON();return n.tags.forEach(function(e){var n=e.tagRaw.toLowerCase();n==="equirectangular"&&(t=!0)}),t})},inEquirectangularGroup:function(){return this.appContext.getModel("photo-groups-models",this.photoId).then(function(e){var t=!1,n=e.toJSON();return n.groups.forEach(function(e){e.id==="44671723@N00"&&(t=!0)}),t})},canVr:function(){var t=this,n,r,i=!1;return t.appContext.flipper.isFlipped("enable-vr")?(n=t.get("photo"),n&&(r=n.getValue("aspectRatio"),r&&r>=1.99&&r<=2.01&&(i=!0)),i?e.Promise.all([t.appContext.callAPI("flickr.vr.isEquirectangular",{photo_id:n.id})]).then(function(t){return e.Promise.resolve(!!t[0].is_equirectangular)}):e.Promise.resolve(!1)):e.Promise.resolve(!1)},onParentViewEvent:function(e,t){var n;if(t&&t[0]){n=t[0];switch(n){case"vrIconClicked":this.openVr();break;case"vKeyPressed":this.toggleVr()}}},toggleVr:function(){this.immersed?this.closeVr():this.openVr()},openVr:function(t){if(this.immersed||t&&t.target.hasClass("close")){this.vr.controls&&this.vr.controls.autoRotate&&(this.vr.controls.autoRotate=!1);return}var n=this,r=this.get("photo"),i=r.getLargestSize(),s=this.templates("flickr-balls")({}),o=new Image,u,a;t&&t.halt(),a=e.Node.create("<div></div>"),a.addClass("vr-loading-layer"),a.addClass("fluid"),a.append(s),n.get("container").append(a),u=i.displayUrl.replace("staticflickr","static.flickr"),o.crossOrigin="anonymous",o.onload=function(){n.immersed=!0,n.vr=new window.Flickvr,n.vr.initialize(u,{container:n.get("container").getDOMNode(),useContainerDimensions:!n.isMobile,enableVrHeadset:n.appContext.flipper.isFlipped("enable-vr-headset"),autoRotate:!n.isMobile}).then(function(t){e.fire("photo:entering-vr"),t.style.position="absolute",n.vr.enterVR(),n.get("container").one(".vr-loading-layer").remove(),n.get("container").addClass("immersed"),n.escHandle=n.attachKeyEvent("down:27",e.betterThrottle(n.closeVr.bind(n),100))})},o.src=u},closeVr:function(e){var t=this.get("container");e&&e.preventDefault(),this.vr&&this.vr.destroy(),this.escHandle&&(this.detachRegisteredEvent(this.escHandle),delete this.escHandle),this.immersed=!1,t.removeClass("immersed")},beforeDestroy:function(){this.set("lastContainer",this.get("container")),this.immersed&&this.closeVr()},destructor:function(){var e=this.get("lastContainer");e&&(e.remove(!0),this.set("lastContainer",null))}})},"@VERSION@",{requires:["flickr-view","better-throttle","get","hermes-template-vr-overlay","hermes-template-flickr-balls"],optional:["photo-models","photo-tags-models","photo-groups-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-lang-photo-page-scrappy_es-us",function(e,t){e.Intl.add("hermes/photo-page-scrappy","es-US",{PAGE_TITLE:["${title}"," | Flickr"],BACK_TO:["Volver a ","${entryType}"],COULDNT_UPDATE_SETTINGS:["No pudimos actualizar tus ajustes"],ADULT_CONTENT:["Contenido para adultos"],MATURE_AUDIENCES:["Este contenido es s\u00f3lo para adultos."],USER_DISCRETION:["Se recomienda discreci\u00f3n."],SHOW_ME_THIS_CONTENT_TYPE:["De ahora en adelante, mostrarme este tipo de contenido"],CHANGE_SAFE_SEARCH_IN_SETTINGS:['Siempre podr\u00e1s cambiar las <a href="/account/prefs/safesearch/?from=privacy"  data-track="photoWellSafeSearchClick">configuraciones de B\u00fasqueda segura</a> en las preferencias de tu cuenta.'],SIGNED_IN_FOR_CONTENT:["Debes iniciar sesi\u00f3n para ver este contenido."],VIDEO_COMING_SOON:["Pronto estar\u00e1 disponible el soporte de videos"],FIND_OUT_MORE_AD:["Descubre m\u00e1s en ","${brand}"],SHARE_THIS_PHOTO:["Compartir esta foto"],DOWNLOAD_THIS_VIDEO:["Descargar este video"],DOWNLOAD_THIS_PHOTO:["Descargar esta foto"],VIEW_ALL_SIZES:["Ver todos los tama\u00f1os"],DOWNLOAD_PHOTO:["Descargar foto"],SOME_RIGHTS_RESERVED:["Algunos derechos reservados"],DOWNLOAD:["Descargar"],ERROR_LOADING_CONTEXT:["Error al cargar el contexto"],ADD_TITLE:["A\u00f1adir t\u00edtulo"],ADD_DESCRIPTION:["A\u00f1adir descripci\u00f3n"],TITLE_DESCRIPTION_FAILURE:["En este momento no pudimos cambiar el t\u00edtulo y la descripci\u00f3n."],VIEW_PREVIOUS_COMMENT:["Ver el comentario anterior"],VIEW_MORE_PREVIOUS_COMMENTS:["Ver ","${count}"," comentarios previos"],EMPTY_COMMENT_ERROR:["\u00bfUn cuadro de comentarios vac\u00edo? \u00a1Eso no funcionar\u00e1!"],COMMENT_RATE_LIMIT_ERROR:["\u00a1B\u00e1jale, amigo! Para proteger a la comunidad Flickr contra el spam y contra comportamientos que parece spam, implementamos unas cuantas restricciones en los comentarios."],COMMENT_POST_ERROR:["No pudimos publicar tu comentario."],MORE_COMMENTS_ERROR:["No pudimos obtener m\u00e1s comentarios."],COMMENT_PERMALINK_ERROR:["No pudimos encontrar el comentario especificado en esta foto."],DELETE_COMMENT:["Eliminar comentario"],COMMENT_DELETE_CONFIRMATION:["\u00bfEst\u00e1s seguro que deseas eliminar este comentario?"],COMMENT_DELETE_ERROR:["No pudimos eliminar tu comentario."],COMMENT_LOADING_ERROR:["Error al cargar comentarios"],COMMENT:["Comentar"],SHOW_MORE_COMMENTS:["${count}"," m\u00e1s"],REPLY:["Responder"],PERMALINK:["Enlace permanente"],SINGLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAlias}",'/">',"${displayName}","</a> marc\u00f3 esto como favorito"],DOUBLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a> y <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}","</a> marcaron esta foto como favorito"],TRIPLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a>, <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}",'</a> y <a class="faved-by-person-link" href="/photos/',"${pathAliasThree}",'/">',"${displayNameThree}","</a> marcaron esta foto como favorito"],MULTI_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a>, <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}",'</a> y <a class="remaining-faved-by" href="#">',"${count}"," personas m\u00e1s</a> marcaron esta foto como favorito"],RELATIONSHIP_FRIEND_ERROR:["Ocurri\u00f3 un error al ajustar la relaci\u00f3n con tu amigo."],RELATIONSHIP_FAMILY_ERROR:["Hubo un problema al configurar la relaci\u00f3n con tu familia."],HIDE_EXIF:["Ocultar EXIF"],SHOW_EXIF:["Mostrar EXIF"],EDIT_LOCATION:["Editar lugar"],EDIT_LOCATION_ORGANIZR:["Estamos trabajando duro para redise\u00f1ar nuestra experiencia fotogr\u00e1fica nueva. A partir de ahora, puedes Editar ubicaci\u00f3n en Organizr."],SAVE_LOCATION:["Guardar ubicaci\u00f3n"],APERTURE:["Apertura"],FOCAL_LENGTH:["Distancia focal"],EXPOSURE_TIME:["Tiempo de exposici\u00f3n"],FLASH_AUTO_FIRED:["Flash (auto, dispar\u00f3)"],FLASH_AUTO_NO_FIRE:["Flash (auto, no dispar\u00f3)"],FLASH_ON_FIRED:["Flash (encendido, dispar\u00f3)"],FLASH_ON_NO_FIRE:["Flash (encendido, no dispar\u00f3)"],FLASH_OFF:["Flash (apagado, no dispar\u00f3)"],FLASH_SIMPLE_ON:["Activada"],FLASH_SIMPLE_OFF:["Desactivada"],POWERED_BY:["IMPULSADO POR"],FOURSQUARE:["FOURSQUARE"],ADD_PHOTO_TO_MAP:["A\u00f1adir esta foto a tu mapa"],SINGULAR_FAVE:["favorito"],PLURAL_FAVE:["favoritos"],SINGULAR_VIEW:["visita"],PLURAL_VIEW:["visitas"],SINGULAR_COMMENT:["comentario"],PLURAL_COMMENT:["comentarios"],LICENSE_ERROR:["Ocurri\u00f3 un error al cambiar la licencia de tu foto"],ALL_RIGHTS_RESERVED:["Todos los derechos reservados"],NO_RESTRICTIONS:["Sin restricciones de derechos de autor conocidas"],PUBLIC_DOMAIN:["Dominio p\u00fablico"],USA_GOV_WORK:["Trabajo del gobierno de los Estados Unidos"],SAFETY_CHANGE_ERROR:["Ocurri\u00f3 un error al cambiar el nivel de seguridad de tu foto."],PRIVACY_CHANGE_ERROR:["Ocurri\u00f3 un error al cambiar la privacidad de tu foto"],COMMENT_PERM_CHANGE_ERROR:["Ocurri\u00f3 un error al cambiar los permisos para comentar tu foto"],FLAG_PHOTO:["Denunciar esta foto"],MARK_FOR_REVIEW:["Marcar para revisi\u00f3n"],ADDITIONAL_INFO:["Informaci\u00f3n adicional"],VIEWING_THIS_PHOTO:["Qui\u00e9n puede ver esta foto"],PRIVACY_UPDATE_ERROR:["Ocurri\u00f3 un error al actualizar la privacidad. Vuelve a intentarlo por favor."],META_PERMS_UPDATE_ERROR:["Ocurri\u00f3 un error al actualizar los permisos para a\u00f1adir metadatos. Vuelve a intentarlo."],ADD_META_TO_THIS_PHOTO:["A\u00f1adir etiquetas y personas a esta foto"],COMMENT_PERMS_UPDATE_ERROR:["Ocurri\u00f3 un error al actualizar los permisos de comentarios. Vuelve a intentarlo por favor."],COMMENTING_ON_THIS_PHOTO:["Comentando sobre esta foto"],SAFETY_UPDATE_ERROR:["Ocurri\u00f3 un error al actualizar el nivel de privacidad. Vuelve a intentarlo por favor."
],SAFETY_LEVEL_OF_PHOTO:["Nivel de seguridad de esta foto"],FLAG_ERROR:["Ocurri\u00f3 un error al tratar de marcar esta foto. Vuelve a intentarlo por favor."],PROVIDE_FEEDBACK:["Danos tu opini\u00f3n sobre la nueva p\u00e1gina de fotos"],ERROR_DELETING_AUTOTAG:["Erro al borrar la Etiqueta autom\u00e1tica"],AUTOTAGS:["Etiquetas autom\u00e1ticas"],CONTACT_LIST_ERROR:["Ocurri\u00f3 un error al tratar de obtener tu lista de contactos. Vuelve a intentarlo por favor."],FAILED_TO_REMOVE_PERSON:["En este momento no se pudo quitar a esa persona de la foto."],PERSON_CANNOT_BE_TAGGED:["No se pudo etiquetar a esta persona."],PEOPLE_IN_PHOTO:["Gente en la foto"],ADD_PEOPLE:["A\u00f1adir personas"],ADD_PERSON:["A\u00f1adir persona"],ERROR_REMOVING_FROM_GROUP:["Hubo un problema al quitar esta foto del grupo"],ERROR_ACCEPTING_INVITATION:["Hubo un problema al aceptar la invitaci\u00f3n del grupo"],SEARCH_GROUPS:["Buscar grupos"],PHOTO_NOT_IN_GROUPS:["En este momento esta foto no est\u00e1 en ning\u00fan grupo"],ADD_TO_GROUP:["A\u00f1adir a un grupo"],INVITE_TO_GROUP:["Invitar al grupo"],ONE_GROUP_INVITATION:["Tienes 1 invitaci\u00f3n a un grupo"],N_GROUP_INVITATIONS:["Tienes ","${count}"," invitaciones a un grupo"],VIEW_MORE_GROUPS:["Ver m\u00e1s grupos"],ERROR_REMOVING_FROM_ALBUM:["Hubo un problema al quitar esta foto del \u00e1lbum"],WARNING_REMOVE_LAST_PHOTO_FROM_ALBUM:["Est\u00e1s a punto de quitar la \u00faltima foto de un \u00e1lbum lo que borrar\u00e1 el \u00e1lbum."],REMOVE_PHOTO_AND_ALBUM:["Quitar la foto y borrar el \u00e1lbum"],ADD_PHOTO_TO_ALBUM:["A\u00f1adir esta foto a un \u00e1lbum"],SEARCH_ALBUMS:["Buscar \u00e1lbumes"],ADD_TO_ALBUM:["A\u00f1adir a un \u00e1lbum"],PHOTO_NOT_IN_ALBUMS:["En este momento esta foto no est\u00e1 en ning\u00fan \u00e1lbum"],VIEW_MORE_ALBUMS:["Ver m\u00e1s \u00e1lbumes"],PHOTO_IN_ONE_ALBUM:["Esta foto est\u00e1 en 1 \u00e1lbum"],PHOTO_IN_N_ALBUMS:["Esta foto est\u00e1 en ","${count}"," \u00e1lbumes"],INVITE_PENDING:["Invitaci\u00f3n pendiente"],CANCEL_INVITE:["Cancelar invitaci\u00f3n"],ACCEPT_INVITE:["Aceptar invitaci\u00f3n"],ONE_ITEM:["1 elemento"],N_ITEMS:["${count}"," elementos"],ERROR_REMOVING_FROM_GALLERY:["Hubo un problema al quitar esta foto de la galer\u00eda"],SEARCH_GALLERIES:["Buscar galer\u00edas"],ADD_TO_GALLERY:["A\u00f1adir a una galer\u00eda"],PHOTO_NOT_IN_GALLERIES:["En este momento esta foto no est\u00e1 en ning\u00fana galer\u00eda"],VIEW_MORE_GALLERIES:["Ver m\u00e1s galer\u00edas"],PHOTO_IN_ONE_GALLERY:["Esta foto est\u00e1 en 1 galer\u00eda"],PHOTO_IN_N_GALLERIES:["Esta foto est\u00e1 en ","${count}"," galer\u00edas"],DELETE_PHOTO:["Eliminar foto"],PERMANTENTLY_DELETE:["\u00bfQuieres eliminar permanentemente esta foto?"],EDIT_PHOTO:["Editar foto"],NO_VIDEO_ROTATION:["No se pudieron girar los videos"],ROTATE:["Girar"],NO_VIDEO_REPLACE:["No se pudieron reemplazar los videos"],REPLACE:["Reemplazar"],PHOTO_NAVIGATION:["Navegaci\u00f3n de la foto"],THUMBNAIL_NAVIGATION:["Navegaci\u00f3n en la vista miniatura"],ZOOM:["Acercar/Alejar"],VIEW_IN_LIGHTBOX:["Ampliar foto"],BACK_TO_CONTEXT:["Volver al contexto"],ADD_TAG:["A\u00f1adir etiqueta"],GO_TO_ORGANIZER:["Ir a Organizr"],ALBUM:["\u00e1lbum"],ALBUMS:["\u00e1lbumes"],ERROR_LOADING_ALBUMS:["Hubo un problema al cargar tus \u00e1lbumes"],ERROR_ADDING_PHOTO_TO_ALBUM:["Hubo un problema al a\u00f1adir esta foto al \u00e1lbum"],ERROR_REMOVING_PHOTO_FROM_ALBUM:["Hubo un problema al quitar esta foto del \u00e1lbum"],ERROR_LOADING_GROUPS:["Hubo un problema al cargar los grupos en los que puedes colocar fotos"],ERROR_ADDING_TO_GROUP:["Hubo un problema al a\u00f1adir esta foto en el grupo"],ERROR_ADDING_TO_GROUP_NOT_OWNER:["Lo sentimos, la foto no se puedo agregar al grupo porque la foto no te pertenece."],ERROR_ADDING_TO_GROUP_NOT_MEMBER:["Lo sentimos, la foto no se pudo agregar al grupo. No eres miembro del grupo."],ERROR_ADDING_TO_GROUP_ALREADY_IN_POOL:["La foto ya se encuentra en ese conjunto del grupo."],ERROR_ADDING_TO_GROUP_MAX_POOLS:["Lo sentimos, la foto no se pudo agregar al grupo porque ya se alcanz\u00f3 la cantidad m\u00e1xima de conjuntos del grupo."],ERROR_ADDING_TO_GROUP_MAX_PHOTOS_FROM_USER:["Lo sentimos, la foto no se pudo agregar al grupo. Ya has agregado la cantidad m\u00e1xima de fotos al conjunto."],ERROR_ADDING_TO_GROUP_ADDED_TO_QUEUE:["Tu foto se ha agregado a la cola pendiente para el grupo."],ERROR_ADDING_TO_GROUP_ALREADY_IN_QUEUE:["Tu foto ya est\u00e1 en la cola pendiente para el grupo."],ERROR_ADDING_TO_GROUP_INVALID_CONTENT:["Lo sentimos, la foto no se pudo agregar al grupo. Para obtener m\u00e1s informaci\u00f3n, verifica los requisitos del grupo con respecto al tipo de medios, al tipo de contenido, al nivel de seguridad y a la ubicaci\u00f3n geogr\u00e1fica."],ERROR_ADDING_TO_GROUP_MAX_IN_POOL:["Lo sentimos, la foto no se pudo agregar al grupo. El grupo tiene la cantidad m\u00e1xima de fotos permitidas en un conjunto."],ERROR_INVITING_TO_GROUP:["Hubo un problema al invitar esta foto al grupo"],ERROR_CANCELING_GROUP_INVITIATON:["Hubo un problema al cancelar la invitaci\u00f3n de esta foto al grupo"],NO_MATCHES:["No se encontraron resultados"],CREATE_NEW:["Crear nuevo"],ERROR_LOADING_GROUP_INVITATIONS:["Hubo un problema al cargar las invitaciones del grupo de esta foto"],NO_GROUP_INVITATIONS:["No hay invitaciones de grupo pendientes"],PENDING_INVITATIONS_FOR_PHOTO:["Invitaciones pendientes de esta foto"],LOADING_INVITATIONS:["Cargando invitaciones"],ERROR_LOADING_GALLERIES:["Hubo un problema al cargar tus galer\u00edas"],ERROR_ADDING_TO_GALLERY:["Hubo un problema al a\u00f1adir esta foto en la galer\u00eda"],ERROR_PHOTO_NOT_ALLOWED_IN_GALLERY:["El propietario de esta foto no permite que la foto se a\u00f1ada a tu galer\u00eda"],ERROR_CREATING_GALLERY:["Ocurri\u00f3 un problema al crear tu galer\u00eda nueva"],DATE_TAKEN_FORMAT:["La fecha en que se tom\u00f3 la foto debe tener el formato MM/DD/AAAA hh:mm:ss."],DATE_POSTED_FUTURE:["La fecha de publicaci\u00f3n no puede ser en el futuro."
],DATE_UPLOADED_FUTURE:["La fecha de subida no puede ser en el futuro."],DATE_POSTED_FLICKR_JOIN:["La fecha de publicaci\u00f3n debe ser despu\u00e9s de que te uniste a Flickr."],DATE_UPLOADED_FLICKR_JOIN:["La fecha de subida debe ser despu\u00e9s de que te uniste a Flickr."],ERROR_SAVING_DATE:["Error al guardar las fechas"],DATE_INVALID:["Una o m\u00e1s fechas son inv\u00e1lidas"],EDIT_DATES:["Editar fechas"],DATE_TAKEN_ON:["Fecha en que se tom\u00f3"],DATE_POSTED_ON:["Fecha en que se public\u00f3"],DATE_UPLOADED_ON:["Fecha de subida:"],TAKEN_CIRCA:["Tomada circa ","${intlDate}"],TAKEN_SOMETIME_IN:["Tomada en alg\u00fan momento durante ","${intlDate}"],TAKEN_IN:["Tomada en ","${intlDate}"],TAKEN_ON:["Tomada el ",{type:"date",valueName:"intlDate",format:"long"}],UPLOADED_ON:["Subida el ","${intlDate}"],SOMETHING_WENT_WRONG:["Algo sali\u00f3 mal."],REFRESH_BROWSER:["Actualiza tu navegador e int\u00e9ntalo nuevamente."],TWITTER_NOT_FOUND:["No se encontr\u00f3 la cuenta de Twitter en la publicaci\u00f3n"],TUMBLR_NOT_FOUND:["No se encontr\u00f3 la cuenta de Twitter en la publicaci\u00f3n"],LINK:["Enlace"],LINK_TO_VIDEO:["Enlace hacia este video:"],LINK_TO_PHOTO:["Enlace hacia esta foto:"],NO_LINKS_FOR_RESTRICTED_VIDEO:["Los enlaces no est\u00e1n disponibles para videos restringidos"],PRIVATE_VIDEO_SHARE:["Este es un video privado \u00bfTodav\u00eda quieres compartirlo?"],NO_LINKS_FOR_RESTRICTED_PHOTO:["Los enlaces no est\u00e1n disponibles para fotos restringidas"],PRIVATE_PHOTO_SHARE:["Esta es una foto privada \u00bfTodav\u00eda quieres compartirla?"],SHARING_RESTRICTED_VIDEO:["No se puede Compartir este video"],SHARING_RESTRICTED_PHOTO:["No se puede Compartir esta foto"],EMBED:["Insertar"],PUBLIC_TO_SHARE:["Para ver el c\u00f3digo incrustado, comparte esta foto"],SIZE:["Tama\u00f1o:"],TITLE_AND_OWNER_AT_START:["Mostrar t\u00edtulo y propietario al inicio"],SHARE_NOW:["\u00a1Mostrar ahora!"],SHARE_PHOTO:["Compartir foto"],SHARE_ON_TWITTER:["Compartir en Twitter"],AUTHORIZE_FOR_TWITTER:["por favor autoriza que Flickr pueda publicar en Twitter"],SHARE_ON_TUMBLR:["Compartir en Tumblr"],PUBLISH_NOW:["Publicar ahora"],ADD_TO_QUEUE:["A\u00f1adir a la cola"],SAVE_AS_DRAFT:["Guardar como borrador"],AUTHORIZE_FOR_TUMBLR:["por favor autoriza que Flickr pueda publicar en Tumblr"],SHARE_VIA_MAIL:["Compartir por correo"],SCREEN_NAME_OR_EMAIL:["Nombre en pantalla o correo electr\u00f3nico"],SQUARE:["Cuadrado"],SMALL:["Peque\u00f1a"],MEDIUM:["Mediana"],LARGE:["Grande"],ORIGINAL:["Original"],DUPLICATE_TAG:["Duplicar etiqueta"],INVALID_TAG:["Etiqueta inv\u00e1lida"],MAXIMUM_TAG_LIMIT:["Se alcanz\u00f3 el l\u00edmite m\u00e1ximo (76) de etiquetas"],MAX_TAG_LIMIT:["Se alcanz\u00f3 el l\u00edmite m\u00e1ximo (75) de etiquetas"],ERROR_ADDING_TAG:["Error al a\u00f1adir la etiqueta"],ERROR_DELETING_TAG:["Error al borrar la etiqueta"],TAGS:["Etiquetas"],ADD_TAGS:["A\u00f1adir etiquetas"],ADD_A_TAG:["A\u00f1adir etiqueta"],PHOTO_IN_ONE_GROUP:["Esta foto est\u00e1 en 1 grupo"],PHOTO_IN_MANY_GROUPS:["Esta foto est\u00e1 en ",{type:"number",valueName:"count"}," grupos"],PHOTO_IN_NO_GROUPS:["Esta foto no est\u00e1 en ning\u00fan grupo"],ADD_A_COMMENT:["A\u00f1adir comentario"],COMMENT_TUTORIAL:["presiona 'Entrar' para publicar y May\u00fasculas+Entrar para agregar una l\u00ednea nueva"],SIGNED_IN_TO_POST_A_COMMENT:["Debes iniciar sesi\u00f3n para publicar un comentario"],SHARE:["Compartir"],CODE:["C\u00f3digo"],INCLUDE_A_MESSAGE:["Incluye un mensaje"],FOR_MORE_INFORMATION_SAFESEARCH:['Para obtener m\u00e1s informaci\u00f3n consulta <a href="//www.flickr.com/help/photos/?search=flag#145">estas Preguntas frecuentes</a>.'],FLAG_CONFIRMATION_SAFE_WITHIN:['Esta foto est\u00e1 marcada como <a href="//www.flickr.com/help/filters/#258">segura</a> coincide con tus criterios de <a href="//www.flickr.com/account/prefs/safesearch/">B\u00fasqueda segura</a>.'],FLAG_CONFIRMATION_SAFE_OUTSIDE:['Esta foto est\u00e1 marcada como <a href="//www.flickr.com/help/filters/#258">segura</a> y no entra en tus ajustes de <a href="//www.flickr.com/account/prefs/safesearch/">b\u00fasqueda segura</a>.'],FLAG_CONFIRMATION_MODERATE_WITHIN:['Esta foto est\u00e1 marcada como <a href="//www.flickr.com/help/filters/#258">moderada</a> coincide con tus criterios de <a href="//www.flickr.com/account/prefs/safesearch/">B\u00fasqueda segura</a>.'],FLAG_CONFIRMATION_MODERATE_OUTSIDE:['Esta foto est\u00e1 marcada como <a href="//www.flickr.com/help/filters/#258">moderada</a> y no entra en tus ajustes de <a href="//www.flickr.com/account/prefs/safesearch/">B\u00fasqueda segura</a>.'],FLAG_CONFIRMATION_RESTRICTED_WITHIN:['Esta foto est\u00e1 marcada como <a href="//www.flickr.com/help/filters/#258">restringida</a> coincide con tus criterios de <a href="//www.flickr.com/account/prefs/safesearch/">b\u00fasqueda segura</a>.'],FLAG_CONFIRMATION_RESTRICTED_OUTSIDE:['Esta foto est\u00e1 marcada como <a href="//www.flickr.com/help/filters/#258">restringida</a> y no entra en tus ajustes de <a href="//www.flickr.com/account/prefs/safesearch/">b\u00fasqueda segura</a>.'],PRIVATE_PHOTO:["Foto privada"],PHOTO_UNFIT_FOR_YOUR_EYES:["Esta foto no es apta para tus ojos. Te damos un gatito: (^._.^)\uff89"],NO_PHOTO_WITH_THAT_ID:["No se encontr\u00f3 una foto con el id ","${photoId}"],NO_MEMBERS_FOUND:["No se encontraron miembros"],TAKEN_ON_INTL:["Tomada el ",{type:"date",valueName:"intlDate",format:"long"}],UPLOADED_ON_INTL:["Subida el ",{type:"date",valueName:"intlDate",format:"long"}],TAKEN_IN_MONTH:["Tomada en ",{type:"date",valueName:"intlDate",format:"monthYear"}],VIEW_IN_LIGHTBOX_SHORTCUT:["Ver en caja de luz"],ZOOM_MAX_MESSAGE:["\u00a1Espera, no te emociones! Esta foto ya lleg\u00f3 al m\u00e1ximo de su tama\u00f1o."],CLICK_TO_FAVE_PHOTO:["Hacer clic aqu\u00ed para marcar esta foto como favorita"],CLICK_TO_FAVE_VIDEO:["Hacer clic aqu\u00ed para marcar este video como favorito"],BACK_TO_ACTIVITY_FEED:["Regresar a la fuente de actividades"],BACK_TO_PHOTOSTREAM:["Regresar a la galer\u00eda"
],BACK_TO_SHARED_PHOTOS:["Volver a fotos compartidas"],BACK_TO_ALBUM:["Regresar al \u00e1lbum"],BACK_TO_CONTACTS_LIST:["Regresar a la lista de contactos"],BACK_TO_FAVORITES:["Regresar a favoritos"],BACK_TO_GALLERY:["Regresar a la expo"],BACK_TO_PROFILE:["Regresar al perfil"],BACK_TO_EXPLORE:["Regresar a la exploraci\u00f3n"],BACK_TO_COMMONS:["Regresar a comunes"],BACK_TO_GROUP:["Regresar al grupo"],BACK_TO_GROUPS:["Volver a grupos"],BACK_TO_MAP:["Regresar al mapa"],BACK_TO_SEARCH:["Regresar a la b\u00fasqueda"],BACK_TO_TAG:["Volver a la etiqueta"],ERROR_ADDING_PHOTOS_TO_ALBUM:["Ocurri\u00f3 un problema al a\u00f1adir estas fotos al \u00e1lbum"],ERROR_REMOVING_PHOTOS_FROM_ALBUM:["Ocurri\u00f3 un problema al quitar estas fotos del \u00e1lbum"],ERROR_CREATING_ALBUM:["Ocurri\u00f3 un problema al crear tu \u00e1lbum nuevo"],STRICTER_PRIVACY_CHANGE_DIALOG_TITLE:["Nivel m\u00e1s estricto de privacidad"],STRICTER_PRIVACY_CHANGE_DIALOG_MESSAGE:["Cuando se aplica un nivel m\u00e1s estricto de privacidad a una foto, se eliminan los favoritos que esta haya acumulado. Tambi\u00e9n cambia la direcci\u00f3n URL de la foto."],TAGS_HELPER_TEXT:["Las etiquetas son palabras clave que facilitan la b\u00fasqueda de fotos. A\u00f1ade tantas como quieras, y los robots amistosos de Flickr intentar\u00e1n ayudarte agregando algunas por ti."],TAGS_HELP_TEXT:["Las etiquetas son palabras claves que permiten que las fotos sean m\u00e1s f\u00e1ciles de encontrar en las b\u00fasquedas de Flickr. Las que t\u00fa a\u00f1adas aparecer\u00e1n en gris oscuro. Los robots amistosos de Flickr intentar\u00e1n ayudar a\u00f1adiendo algunas por ti, estas aparecer\u00e1n solo con un contorno gris."],PRIVATE_TAGS_OWNER_HELPER_TEXT:["Esta etiqueta privada solo pueden verla t\u00fa, tus amigos y tu familia, que est\u00e1n autorizados a ver esta foto."],PRIVATE_TAGS_FRIENDS_FAMILY_HELPER_TEXT:["Esta etiqueta privada solo puedes verla t\u00fa, porque eres amigo o familiar del propietario de la foto."],CREATE_WALLART_WITH_PHOTO:["Crear cuadro con esta foto"],ERROR_ROTATING_PHOTO:["Se produjo un error al intentar girar esta foto. Cierra e int\u00e9ntalo nuevamente."],ROTATE_PHOTO:["Girar foto"],ERROR_REPLACING_PHOTO:["Se produjo un error al intentar reemplazar esta foto. Cierra e int\u00e9ntalo nuevamente."],REPLACE_PHOTO:["Reemplazar foto"],PERMANENTLY_REPLACE:['\u00bfDeseas reemplazar de forma permanente esta foto ("',"${photoTitle}",'" por ',"${username}",") por <em>","${fileName}","</em>?"],REPLACE_WARNING:["Si reemplazas una foto, esta acci\u00f3n no puede deshacerse. Elige un archivo para reemplazar esta foto."],REPLACE_UPLOADING:["Subiendo <em>","${fileName}","</em>..."],ERROR_DELETING_PHOTO:["Se produjo un error al intentar eliminar esta foto. Cierra e int\u00e9ntalo nuevamente."],SHOW_MORE_STATS:["Mostrar m\u00e1s estad\u00edsticas"],SIGNUP_AND_DOWNLOAD_TITLE:["\u00a1Encontraste una foto para descargar!"],SIGNUP_AND_DOWNLOAD_VIDEO_TITLE:["\u00a1Encontraste un video para descargar!"],SIGNUP_AND_DOWNLOAD_MESSAGE:["\u00danete a Flickr y accede a miles de millones de fotos."],SIGNUP_AND_COMMENT_TITLE:["\u00a1Deja un comentario en esta foto!"],SIGNUP_AND_COMMENT_MESSAGE:["\u00danete a Flickr y podr\u00e1s dejar un comentario en esta foto."],IMMERSIFY:["Sum\u00e9rgete"],SIGNUP_FOOTER_MESSAGE:["\u00danete a Flickr para explorar fotos de clase mundial"],TIMEOUT_FAILURE:["En este momento, estamos teniendo problemas para mostrar esta foto. Vuelve a intentarlo."],BUY:["Comprar"],ADD_A_NOTE:["Agregar una nota"],CONFIRM_NOTE_DELETION:["\u00bfSeguro que deseas eliminar de manera definitiva esta nota?"],VIEWING_PRIVACY:["Privacidad de la vista"],ALLOW_COMMENTING:["Permitir comentarios"],ALLOW_TAGS_NOTES_PEOPLE:["Permitir etiquetas, notas y etiquetas de personas"],SAFETY_LEVEL:["Nivel de seguridad"],SET_SAFETY_LEVEL:["Establecer el nivel de seguridad"],KEYBOARD_SHORTCUTS:["Atajos del teclado"],EDITOR_UPGRADE:["Photo Editor Upgrade"],EDITOR_UPGRADE_MESSAGE:["The edit photo feature on the Flickr photo page is currently disabled pending an upgrade.<br><br>Very shortly, you\u2019ll have access to a more stable, more feature rich photo editor to complement your Flickr experience!<br><br>Sorry for the inconvenience of this unexpected upgrade, but we\u2019re confident it will be worth the wait."],ERROR_REPLACING_PHOTO_FILE_TYPE:["Se produjo un error al reemplazar una foto.  No se reconoci\u00f3 el tipo de archivo. Prueba con otra foto."]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-zoom",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){return""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/zoom",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-zoom-modal",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return'<img src="'+e.escapeExpression((s=(s=n.smallSrc||(t!=null?t.smallSrc:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"smallSrc",hash:{},data:i}):s))+'" class="zoom-small">'},3:function(e,t,n,r,i){var s;return'<img src="'+e.escapeExpression((s=(s=n.largeSrc||(t!=null?t.largeSrc:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"largeSrc",hash:{},data:i}):s))+'" class="zoom-large">'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{};return'<div class="zoom-modal hidden">\n	<div class="zoom-photo-container">\n		'+((s=n["if"].call(o,t!=null?t.smallSrc:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n		"+((s=n["if"].call(o,t!=null?t.largeSrc:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n		<span class="facade-of-protection-zoom"></span>\n	</div>\n</div>\n'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/zoom-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("animation-manager",function(e){e.AnimationManager=function(){function i(){return n=!1,r=[],!YUI.Env.isServer&&!e.config.win.requestAnimationFrame&&s(),{subscribe:u}}function s(){var t=["webkit","moz"],n,r,i=0;for(r=0;r<t.length&&!e.config.win.requestAnimationFrame;++r)n=t[r],e.config.win.requestAnimationFrame=e.config.win[n+"RequestAnimationFrame"],e.config.win.cancelAnimationFrame=e.config.win[n+"CancelAnimationFrame"]||e.config.win[n+"CancelRequestAnimationFrame"];if(!e.config.win.requestAnimationFrame||!e.config.win.cancelAnimationFrame)e.config.win.requestAnimationFrame=function(e){var t=Date.now(),n=Math.max(i+16,t);return setTimeout(function(){e(i=n)},n-t)},e.config.win.cancelAnimationFrame=clearTimeout}function o(){if(!n)return;r.forEach(function(e,t){e()}),e.config.win.requestAnimationFrame(o)}function u(t){return r.push(t),n||(n=!0,e.config.win.requestAnimationFrame(o)),{detach:function(){r.splice(r.indexOf(t),1),r.length||(n=!1)}}}var t,n,r;return t||(t=i()),t}()},"@VERSION@",{requires:[]});
YUI.add("zoom-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,forceGpu:null,initializer:function(t){return this.photoId=t.photoId,this.disableIfSmall=!!t.disableIfSmall,YUI.Env.isServer||(e.config.win.location.search.indexOf("gpu=on")>-1?this.forceGpu=!0:e.config.win.location.search.indexOf("gpu=off")>-1&&(this.forceGpu=!1)),this},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){return this.setContainerWithTemplate("zoom"),this},activate:function(){var t=this,n=t.getZoomKeyScope();return this.get("photo").getValue("needsInterstitial")||(this.parentViewContainer=this.get("container").ancestor(".view"),t.registerEventHandler(t.get("container").on("click",function(n){n.preventDefault(),t.cursorCoords=[n.pageX-e.config.win.pageXOffset,n.pageY-e.config.win.pageYOffset],e.rapidTracker.beacon(t.name,"zoomInClick"),t.zoomIn(t.cursorCoords)})),t.registerEventHandler(e.on("photo:zoom",function(n){n.x&&n.y?(t.cursorCoords=[n.x-e.config.win.pageXOffset,n.y-e.config.win.pageYOffset],t.zoomIn(t.cursorCoords)):t.zoomIn(),e.rapidTracker.beacon(t.name,"zoomInRemoteFire")})),t.attachKeyEvent("down:90",e.betterThrottle(function(n){n.preventDefault(),e.rapidTracker.beacon(t.name,"zoomInKeyPress"),t.zoomIn()},100)),t.attachKeyEvent("down:90,27",e.betterThrottle(function(n){n.preventDefault(),e.rapidTracker.beacon(t.name,"zoomOutKeyPress"),t.zoomOut()},100),n),t.attachKeyEvent("down:37,38,39,40",e.betterThrottle(function(n){var r=[t.currentZoomRegion.left,t.currentZoomRegion.top],i=200;n.preventDefault();switch(n.button){case 37:r[0]+=i;break;case 38:r[1]+=i;break;case 39:r[0]-=i;break;case 40:r[1]-=i}e.rapidTracker.beacon(t.name,"zoomPanKeyPress"),t.panZoomNode(r)},16),n),t.registerEventHandler(t.appContext.flapp.before("activeViewChange",function(n){e.fire("flickr:removeKeyEventScope",t.getZoomKeyScope()),t.detachRegisteredEvents(),t.detachEventHandlers(),t.cleanUp()}))),this},getZoomEdgeMargin:function(){return 100},panZoomNodeToCurrentCoords:function(){if(!this.zoomedIn)return;var e=this.cursorCoords,t=this.getZoomPanCoordsForCursor(e);if(!t)return;this.panZoomNode(t)},panZoomNode:function(e){if(this.currentZoomRegion.left===e[0]&&this.currentZoomRegion.top===e[1])return;e=this.constrainPanCoords(e),this.currentZoomRegion.left=e[0],this.currentZoomRegion.top=e[1],this.pendingCoords=e},constrainPanCoords:function(e){var t,n,r,i,s=this.getZoomEdgeMargin(),o=[this.appContext.viewportData.getWidth(),this.appContext.viewportData.getHeight()],u=[this.zoomImageFullWidth,this.zoomImageFullHeight],a=[u[0]+2*s,u[1]+2*s];return t=0,n=o[0]-u[0]-2*s,r=0,i=o[1]-u[1]-2*s,e[0]>t?e[0]=t:e[0]<n&&(e[0]=n),e[1]>r?e[1]=r:e[1]<i&&(e[1]=i),u[0]<o[0]&&(e[0]=.5*(o[0]-a[0])),u[1]<o[1]&&(e[1]=.5*(o[1]-a[1])),e},getZoomPanCoordsForCursor:function(e){if(!e)return;var t=this.getZoomEdgeMargin(),n=[this.appContext.viewportData.getWidth(),this.appContext.viewportData.getHeight()],r=[this.zoomImageFullWidth,this.zoomImageFullHeight],i=[r[0]+2*t,r[1]+2*t],s=[e[0]/n[0],e[1]/n[1]],o=[s[0]*(n[0]-i[0]),s[1]*(n[1]-i[1])];return o},getZoomSmallRegion:function(){var t=this.get("container");return{left:t.getX()-e.config.win.pageXOffset-this.getZoomEdgeMargin(),top:t.getY()-e.config.win.pageYOffset-this.getZoomEdgeMargin(),width:parseInt(t.getStyle("width"),10),height:parseInt(t.getStyle("height"),10)}},resizeZoomNode:function(t,n){var r=this,i,s,o=e.config.win.performance&&e.config.win.performance.now;return n?new e.Promise(function(n,u){function a(e){var u=o?e-i:Date.now()-i,a=u/r.getZoomTransitionTime(),f;return a>=1?(f=t,r.isAnimatingZoom=!1,setTimeout(function(){n()},r.getZoomTransitionTime())):f={left:s.left+(t.left-s.left)*a,top:s.top+(t.top-s.top)*a,width:s.width+(t.width-s.width)*a,height:s.height+(t.height-s.height)*a},f}function f(n){var i=a(n);if(r.zoomingIn||r.zoomingOut)r.resizeZoomNode(i,!1),i!==t&&e.config.win.requestAnimationFrame(f)}r.isAnimatingZoom=!0,i=o?e.config.win.performance.now():Date.now(),s=r.currentZoomRegion,e.config.win.requestAnimationFrame(f)}):(this.currentZoomRegion=t,this.zoomPhotoContainerNode&&this.zoomPhotoContainerNode.setStyle("transform","translate("+t.left+"px, "+t.top+"px) scale("+t.width/this.zoomImageFullWidth+")"),e.Promise.resolve())},getZoomTransitionTime:function(){return 200},zoomOut:function(){var t=this,n=this.zoomNode;e.fire("flickr:removeKeyEventScope",this.getZoomKeyScope()),this.detachEventHandlers(),this.resizeZoomNode(this.getZoomSmallRegion(),!0),n.addClass("hiding"),this.zoomedIn=!1,this.zoomingIn=!1,this.zoomingOut=!0,setTimeout(function(){t.zoomingOut&&n&&n._node&&(t.parentViewContainer.removeClass("zoomed"),n.removeClass("hiding"),n.addClass("hidden"),setTimeout(function(){t.zoomingOut&&(t.cleanUp(),this.zoomingOut=!1)},200))},this.getZoomTransitionTime()+0),delete this.pendingCoords,delete this.currentCoords},detachEventHandlers:function(){this.zoomNode&&(this.zoomNode.detachAll("mousemove"),this.mouseWheelHandler&&this.mouseWheelHandler.detach(),this.touchHandlers&&(this.touchHandlers.forEach(function(e){e.detach()}),delete this.touchHandlers))},cleanUp:function(){this.zoomNode&&(this.zoomNode.remove(!0),this.zoomedIn=!1,this.zoomingIn=!1,this.zoomingOut=!1,delete this.zoomNode,delete this.zoomPhotoContainerNode,delete this.pendingCoords,delete this.currentCoords,this.zoomAnimationHandle.detach())},isImageReadyToDisplay:function(e){var t;return e?(t=new Image,t.src=e,t.complete||t.naturalWidth):!1},getZoomKeyScope:function(){return this.name+this._yuid},zoomMouseMoveHandler:function(t){this.cursorCoords=[t.pageX-e.config.win.pageXOffset,t.pageY-e.config.win.pageYOffset],this.isAnimatingZoom||this.panZoomNodeToCurrentCoords()},zoomScrollWheelHandler:function(e){e.preventDefault();var t=e.wheelDeltaX,n=e.wheelDeltaY;t===undefined&&(t=-e.deltaX||0),n===undefined&&(n=-e.deltaY||0),this.panZoomNode([this.currentZoomRegion.left+t,this
.currentZoomRegion.top+n])},getSizes:function(){var e=this.parentViewContainer.one(".low-res-photo"),t=this.parentViewContainer.one(".main-photo");return{small:e?e.getAttribute("src"):"",medium:t?t.getAttribute("src"):"",large:this.getLargestSize()}},getLargestSize:function(){var e=this.appContext.flipper.isFlipped("enable-zoom-proxy"),t=this.appContext.flipper.config["zoom-proxy-prefix"],n;return e&&t?(n=this.get("photo").getLargestSize({excludeSizes:[]}),n.key==="o"&&(console.log("proxyPrefix",t,"largestSize.displayUrl",n.displayUrl),n.displayUrl=n.url=t+"http:"+n.displayUrl,console.log("proxying original",n.url))):n=this.get("photo").getLargestSize(),n},zoomIn:function(t){var n=this,r,i,s=this.getSizes(),o=this.isImageReadyToDisplay(s.medium),u=this.isImageReadyToDisplay(s.large.url),a=this.getZoomPixelRatio(),f=this.getZoomSmallRegion(),l,c,h,p=this.maxMsgNode;if(this.disableIfSmall&&f.width>=s.large.width){p||(p=this.maxMsgNode=e.Node.create('<div class="zoom-max-message">'+n.intlMessage({intlName:"photo-page-scrappy.ZOOM_MAX_MESSAGE"})+"</div>")),this.get("container").contains(p)||(p.addClass("hidden"),this.get("container").append(p)),setTimeout(function(){p&&p.inDoc()&&(p.removeClass("hidden"),this.maxMsgNodeHidingTimer&&(clearTimeout(this.maxMsgNodeHidingTimer),delete this.maxMsgNodeHidingTimer),this.maxMsgNodeHidingTimer=setTimeout(function(){p&&p.inDoc()&&p.addClass("hidden")},3e3))},0);return}e.fire("flickr:setKeyEventScope",this.getZoomKeyScope()),this.zoomingIn=!0,this.zoomAnimationHandle=e.AnimationManager.subscribe(function(){var r=n.getDeteriorationRateForEasing(),i,s,o={x:0,y:0},u={x:0,y:0},a={x:0,y:0};if(n.pendingCoords){o.x=parseInt(n.pendingCoords[0],10),o.y=parseInt(n.pendingCoords[1],10),n.currentCoords?(u.x=n.currentCoords[0],u.y=n.currentCoords[1]):(i=n.getZoomPanCoordsForCursor(t),s=n.constrainPanCoords(i),u.x=parseInt(s[0],10),u.y=parseInt(s[1],10)),o.x<u.x?a.x=u.x-Math.abs(o.x-u.x)*r:a.x=u.x+Math.abs(o.x-u.x)*r,o.y<u.y?a.y=u.y-Math.abs(o.y-u.y)*r:a.y=u.y+Math.abs(o.y-u.y)*r,a.x=parseInt(a.x,10),a.y=parseInt(a.y,10),a.x===u.x&&(o.x<u.x?a.x=u.x-1:o.x>u.x&&(a.x=u.x+1)),a.y===u.y&&(o.y<u.y?a.y=u.y-1:o.y>u.y&&(a.y=u.y+1));if(a.x!==o.x||a.y!==o.y)(n.forceGpu===!0||e.config.win.devicePixelRatio>1)&&n.forceGpu!==!1?n.zoomPhotoContainerNode.setStyle("transform","translate3d("+a.x+"px, "+a.y+"px, 0)"):n.zoomPhotoContainerNode.setStyle("transform","translate("+a.x+"px, "+a.y+"px)");n.currentCoords=[a.x,a.y],a.x===o.x&&a.y===o.y&&delete n.pendingCoords}}),this.zoomNode?(this.zoomingOut=!1,r=this.zoomNode,r.removeClass("hiding"),this.detachEventHandlers()):r=this.zoomNode=e.Node.create(this.templates("zoom-modal")({smallSrc:o?s.medium:s.small,largeSrc:u?s.large.url:""})),i=this.zoomPhotoContainerNode=r.one(".zoom-photo-container"),this.zoomImageFullWidth=s.large.width/a,this.zoomImageFullHeight=s.large.height/a,t||(t=[this.appContext.viewportData.viewport.width/2,this.appContext.viewportData.viewport.height/2],n.cursorCoords=t),l=this.getZoomPanCoordsForCursor(t),l=this.constrainPanCoords(l),c={left:l[0],top:l[1],width:this.zoomImageFullWidth,height:this.zoomImageFullHeight},i.setStyle("transition","none"),this.resizeZoomNode(f,!1),r.on("click",function(t){if(n.zoomingIn)return;t.preventDefault(),e.rapidTracker.beacon(n.name,"zoomOutClick"),n.zoomOut()}),e.one("body").append(r),i.setStyle("width",c.width),i.setStyle("height",c.height),e.soon(function(){if(n.zoomingIn){r.removeClass("hidden"),i.setStyle("transition",""),"ontouchstart"in document&&e.use("event-touch",function(){n.touchHandlers=[],n.touchHandlers.push(e.on("touchstart",function(e){e.changedTouches.length&&e.changedTouches.length===1&&(n.touching=[e.changedTouches[0].pageX,e.changedTouches[0].pageY])})),n.touchHandlers.push(e.on("touchmove",function(e){var t=e.pageX,r=e.pageY,i,s;n.touching&&e.changedTouches.length&&e.changedTouches.length===1&&(t=e.changedTouches[0].pageX,r=e.changedTouches[0].pageY,e.preventDefault(),i=t-n.touching[0],s=r-n.touching[1],n.touching=[t,r],n.panZoomNode([n.currentZoomRegion.left+i,n.currentZoomRegion.top+s]))})),n.touchHandlers.push(e.on("touchend",function(e){delete n.touching}))});if(!("ontouchstart"in document)||n.appContext.flipper.isFlipped("enable-always-bind-mouse-events-zoom-view"))r.on("mousemove",n.zoomMouseMoveHandler.bind(n)),n.mouseWheelHandler=function(){var e=n.zoomScrollWheelHandler.bind(n);return h="onwheel"in document.createElement("div")?"wheel":"mousewheel",document.addEventListener(h,e,!1),{detach:function(){document.removeEventListener(h,e,!1)}}}();n.parentViewContainer.addClass("zoomed"),n.resizeZoomNode(c,!0).then(function(){n.zoomingIn&&(n.zoomingIn=!1,n.zoomedIn=!0,n.panZoomNodeToCurrentCoords(),u||i.append('<img src="'+s.large.url+'" class="zoom-large">'))})}})},getDeteriorationRateForEasing:function(){return.2},getZoomPixelRatio:function(){return 1}})},"@VERSION@",{requires:["flickr-view","better-throttle","flickr-promise","hermes-template-zoom","hermes-template-zoom-modal","animation-manager"],optional:["photo-models"],langBundles:["photo-page-scrappy"]});
YUI.add("hermes-template-photo-well-media-scrappy",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o=t!=null?t:{};return'	<div class="restricted-interstitial">\n		<div class="restricted-interstitial-message">\n			<h2>'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADULT_CONTENT"},data:i}))+"</h2>\n"+((s=n["if"].call(o,t!=null?t.isSignedIn:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.program(5,i,0),data:i}))!=null?s:"")+"		</div>\n	</div>\n"},2:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return"				<p>"+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.MATURE_AUDIENCES"},data:i}))+"<br />"+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.USER_DISCRETION"},data:i}))+"</p>\n\n"+((s=n.unless.call(o,t!=null?t.isMinor:t,{name:"unless",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")},3:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return"					<p><button class='ui-button'><span>"+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_ME_THIS_CONTENT_TYPE"},data:i}))+"</span></button></p>\n					<p>"+u((n.intlHTMLMessage||t&&t.intlHTMLMessage||o).call(s,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.CHANGE_SAFE_SEARCH_IN_SETTINGS"},data:i}))+"</p>\n"},5:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return"				<p>"+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SIGNED_IN_FOR_CONTENT"},data:i}))+' <a href="//'+a((s=(s=n.host||(t!=null?t.host:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"host",hash:{},data:i}):s))+'/signin/" data-track="photoWellSignInClick">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:i}))+"</a></p>\n"},7:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isVideo:t,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.program(11,i,0),data:i}))!=null?s:""},8:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isPending:t,{name:"if",hash:{},fn:e.noop,inverse:e.program(9,i,0),data:i}))!=null?s:""},9:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'		<div class="videoplayer main-photo" style="width:'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+"px; height:"+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'px;"><video id="video_1" poster="'+f((s=(s=n.src||(t!=null?t.src:t))!=null?s:u,typeof s===a?s.call(o,{name:"src",hash:{},data:i}):s))+'" class="video-js vjs-big-play-centered inherit-size"></video></div>\n'},11:function(e,t,n,r,i){var s;return"\n"+((s=n["if"].call(t!=null?t:{},t!=null?t.showFuzzy:t,{name:"if",hash:{},fn:e.program(12,i,0),inverse:e.program(14,i,0),data:i}))!=null?s:"")},12:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'		<span class="restricted-image main-photo" style="width:'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+"px;height:"+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'px;">\n		</span>\n'},14:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'		<span class="facade-of-protection-neue" style="width:'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+"px;height:"+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'px;">\n			'+f((n.outlet||t&&t.outlet||u).call(o,t!=null?t["zoom-view"]:t,{name:"outlet",hash:{},data:i}))+"\n			"+f((n.outlet||t&&t.outlet||u).call(o,t!=null?t["vr-overlay-view"]:t,{name:"outlet",hash:{},data:i}))+'\n		</span>\n\n		<img width="'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+'" height="'+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'" src="'+f((s=(s=n.src||(t!=null?t.src:t))!=null?s:u,typeof s===a?s.call(o,{name:"src",hash:{},data:i}):s))+'" class="low-res-photo" alt="'+f((s=(s=n.imgAltText||(t!=null?t.imgAltText:t))!=null?s:u,typeof s===a?s.call(o,{name:"imgAltText",hash:{},data:i}):s))+'">\n		<img width="'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+'" height="'+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'" src="'+f((s=(s=n.highResSrc||(t!=null?t.highResSrc:t))!=null?s:u,typeof s===a?s.call(o,{name:"highResSrc",hash:{},data:i}):s))+'" class="main-photo is-hidden" onload="registerFirstPhoto(this)" alt="'+f((s=(s=n.imgAltText||(t!=null?t.imgAltText:t))!=null?s:u,typeof s===a?s.call(o,{name:"imgAltText",hash:{},data:i}):s))+'">\n		<noscript>\n			<img width="'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+'" height="'+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'" src="'+f((s=(s=n.highResSrc||(t!=null?t.highResSrc:t))!=null?s:u,typeof s===a?s.call(o,{name:"highResSrc",hash:{},data:i}):s))+'" class="main-photo" alt="'+f((s=(s=n.imgAltText||(t!=null?t.imgAltText:t))!=null?s:u,typeof s===a?s.call(o,{name:"imgAltText",hash:{},data:i}):s))+'">\n		</noscript>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.needsInterstitial:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program
(7,i,0),data:i}))!=null?s:""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well-media-scrappy",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-well-media-scrappy-view",function(e,t){var n=require("lib/flog")(t),r=500,i=500,s=40,o;o={photo:{render:function(){var t=this,n=this.get("photo"),r,i,s,o="";return t.preloadImage&&(t.preloadImage.onload=null),this.appContext.forceServerRender?(r=this.getPhotoForDisplay({canvas:{width:Number.MAX_VALUE,height:Number.MAX_VALUE}}),i=r):(r=this.getPhotoForDisplay(),i=this.getPhotoForDisplay({includeSizes:["sq","q","t","s","n"]})),n.getValue("owner")&&(n.getValue("title").trim()===""?o=this.intlMessage({intlName:"common.UNTITLED"}):o=n.getValue("title"),o+=" | "+this.intlMessage({intlName:"common.BY_USER",user:n.getValue("owner").getValue("username")})),s=this.get("container").one(".main-photo"),(!s||parseInt(s.getAttribute("width"),10)!==r.width||parseInt(s.getAttribute("height"),10)!==r.height)&&this.setContainerWithTemplate("photo-well-media-scrappy",{width:r.width,height:r.height,src:i.url,highResSrc:r.url,imgAltText:o,needsInterstitial:n.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isVideo:!1,isMinor:this.appContext.getViewer().isMinor}),YUI.Env.isServer?(this.serverWidth=r.width,this.serverHeight=r.height):n.getValue("needsInterstitial")||(t.preloadImage=new Image,t.preloadImage.onload=function(){if(this.onloadFired)return;if(!t.isActiveAndInDOM())return;this.onloadFired=!0;var n,i="photoPageShowedSize",s="\u00f8";try{n=/(?:_([a-z]))?\.jpg/.exec(r.url),n&&n[1]&&(s=n[1])}catch(o){}finally{i+=String(s).toUpperCase()}e.rapidTracker.beacon(this.name,i);var u=t.get("container").one(".low-res-photo"),a=t.get("container").one(".main-photo");a.removeClass("is-hidden").show(),u.hide()},t.preloadImage.src=r.url,t.preloadImage.complete&&t.preloadImage.onload()),this}},video:{render:function(){var e=this.get("photo"),t=this.getPhotoForDisplay({excludeSizes:[]});return!this.player||e.getValue("isVideoPending")?(this.setContainerWithTemplate("photo-well-media-scrappy",{width:t.width,height:t.height,src:t.url,needsInterstitial:e.getValue("needsInterstitial"),isVideo:!0,isSignedIn:this.appContext.getViewer().signedIn,"zoom-view":"",isPending:e.getValue("isVideoPending")}),this):(e.getValue("isVideoPending")||(this.player.dimension?(this.player.dimension("width",t.width),this.player.dimension("height",t.height)):this.player.resize(t.width,t.height)),this)}},ad:{render:function(){return this}}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"zoom-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"vr-overlay-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,destinationContainer:".photo-well-media-scrappy-view",disabled:function(){return!this.appContext.flipper.isFlipped("enable-vr")}}},initializer:function(e){return this.photoId=e.photoId,this.isAd=!!e.ad,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var t=this;return this.appContext.getModel("photo-models",t.photoId).then(function(n){t.set("photo",n);if(n.getValue("isVideo"))return new e.Promise(function(t,n){e.use("flickr-video-player",function(){t()})})})},buildContainer:function(){return YUI.Env.isServer||this.set("clientRendered",!0),this.isAd?o.ad.render.call(this):o[this.get("photo").getValue("isVideo")?"video":"photo"].render.call(this),!YUI.Env.isServer&&this.subviews["vr-overlay-view"]&&this.subviews["vr-overlay-view"].get("canVr")&&this.subviews["zoom-view"]&&(this.canVR=!0,this.subviews["zoom-view"].destroy({remove:!0})),this.get("photo").getValue("needsInterstitial")?this.get("container").addClass("has-interstitial"):this.get("container").removeClass("has-interstitial"),this},handleInterstitialDismissButtonClick:function(t){var r=this,i=this.get("personPreferences"),s=this.get("photo"),o=s.getValue("safetyLevel");e.rapidTracker.beacon(this.name,"restrictedContentInterstitialClick"),i.setValue("safeSearch",o),i.registry.remoteUpdate(r.appContext.auth.user.nsid).then(function(e){var t=s.registry.attributeSearch({needsInterstitial:!0});t.forEach(function(e){s.registry.getValue(e,"safetyLevel")<=i.getValue("safeSearch")&&s.registry.setValue(e,"needsInterstitial",!1)}),r.buildContainer(),r.fire("subviewViewEvent","photoWellResized")},function(e){n.error({err:e}),r.onError(r.intlMessage({intlName:"photo-page-scrappy.COULDNT_UPDATE_SETTINGS"}))})},onParentViewEvent:function(e,t){t&&t[0]==="photoWellResized"&&(this.get("photo").getValue("needsInterstitial")||(this.set("canvasSizeIsDirty",!0),this.buildContainer()))},activate:function(){var t=this;return this.get("photo").getValue("isVideo")&&!this.get("photo").getValue("isVideoPending")&&(t.player=new e.FlickrVideoPlayer({container:t.get("container").one(".videoplayer"),model:t.get("photo"),appContext:t.appContext,videoNode:e.one("#video_1")?e.one("#video_1")._node:null,controlBar:{fullscreenToggle:!1}}),t.player.init().then(function(){}),t.on("destroy",function(){t.player&&(t.player.destroy(),t.player=null)})),this.get("photo").getValue("needsInterstitial")||this.registerEventHandler(e.on("flickr:photo-media-well-update",function(e){t.set("canvasSizeIsDirty",!0),t.buildContainer()})),this.appContext.getViewer().signedIn&&this.appContext.getModel("person-preferences-models",t.appContext.auth.user.nsid).then(function(e){t.set("personPreferences",e),t.get("photo").getValue("needsInterstitial")&&!this.appContext.getViewer().isMinor&&t.get("container").one(".restricted-interstitial-message button")&&t.registerEventHandler(t.get("container").one(".restricted-interstitial-message button").on("click",t.handleInterstitialDismissButtonClick,t))}),this},onError:function(t){var n=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:this.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),message:t,classList:"scrappy-dialog"});n.show()},getPhotoForDisplay:function(e){var t=this.getCanvasSize(),n=this.getPixelRatio(),r,i,s
;return e&&e.canvasSize&&(t=e.canvasSize),r=this.get("photo").getSizeToFit(t,e),i=Math.min(t.height/n,r.height),s=Math.min(t.width/n,r.width/r.height*i),i=Math.min(i,r.height/r.width*s),{width:Math.round(s),height:Math.round(i),url:r.url,pixelRatio:r.width/s}},getCanvasSize:function(){var e,t=this.getPixelRatio(),n,o=this.get("container"),u,a,f,l,c={width:r,height:i};return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(n=this.get("container").ancestor(),u=o.getStyle("paddingTop")?parseInt(o.getStyle("paddingTop").match(/[0-9]+/)[0],10):0,a=o.getStyle("paddingBottom")?parseInt(o.getStyle("paddingBottom").match(/[0-9]+/)[0],10):0,l=s,f=s,n&&(e=n.get("region"),e.height=parseInt(n.getStyle("height").match(/[0-9]+/)[0],10)-(u+a),e.width=this.appContext.viewportData.viewport.width-(l+f))):e=this.get("cachedCanvasSize"),this.appContext.viewportData.viewport.width>0&&(c={width:this.appContext.viewportData.viewport.width,height:this.appContext.viewportData.viewport.height-240}),e||(e={top:0,left:0,bottom:i,right:r,width:c.width,height:c.height}),e.height*=t,e.width*=t,e},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{ATTRS:{canvasSizeIsDirty:{value:!0,setter:function(e){return!!e}},cachedCanvasSize:{getter:function(t){return e.merge(t)},setter:function(t){return e.merge(t)}}}})},"@VERSION@",{requires:["flickr-view","moment","vr-overlay-view","zoom-view","hermes-template-photo-well-media-scrappy"],optional:["photo-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-context-slider-photo",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return"currentImage"},3:function(e,t,n,r,i){return"restricted-image"},5:function(e,t,n,r,i){return"		<span class='play-slideshow'>&#9654;</span>\n		<span class='countdown-slideshow'></span>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'<a class="context-thumb emptyImage '+((s=n["if"].call(u,t!=null?t.currentPhoto:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+" "+((s=n["if"].call(u,t!=null?t.needsInterstitial:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+'" href="'+l((o=(o=n.url||(t!=null?t.url:t))!=null?o:a,typeof o===f?o.call(u,{name:"url",hash:{},data:i}):o))+'" data-track="contextSliderNextPhotoClick" style="background-image: url('+l((o=(o=n.background||(t!=null?t.background:t))!=null?o:a,typeof o===f?o.call(u,{name:"background",hash:{},data:i}):o))+"); left: "+l((o=(o=n.left||(t!=null?t.left:t))!=null?o:a,typeof o===f?o.call(u,{name:"left",hash:{},data:i}):o))+'px" data-photo-id="'+l((o=(o=n.id||(t!=null?t.id:t))!=null?o:a,typeof o===f?o.call(u,{name:"id",hash:{},data:i}):o))+'" title="'+l((o=(o=n.title||(t!=null?t.title:t))!=null?o:a,typeof o===f?o.call(u,{name:"title",hash:{},data:i}):o))+'" tabindex="-1">\n'+((s=n["if"].call(u,t!=null?t.currentPhoto:t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.noop,data:i}))!=null?s:"")+"</a>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/context-slider-photo",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-context-slider-scrappy",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return"	<div class='loadingError'>\n		<p>"+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ERROR_LOADING_CONTEXT"},data:i}))+'</p>\n		<p><button href="#" class="ui-button ui-button-cta ui-button-transparent retry">'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"common.RETRY"},data:i}))+"</button></p>\n	</div>\n"},3:function(e,t,n,r,i){var s,o=t!=null?t:{};return"\n	<div class='context-slider small-slider "+((s=n["if"].call(o,t!=null?t.slideshowEnabled:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\'>\n\n		<div class="wrapper is-ready clear-float small-photos">\n\n			<div class="slider">\n\n'+((s=n.each.call(o,t!=null?t.previousPhotos:t,{name:"each",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t["is-ad"]:t,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.program(10,i,0),data:i}))!=null?s:"")+"\n\n"+((s=n.each.call(o,t!=null?t.nextPhotos:t,{name:"each",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n			</div>\n\n		</div>\n\n	</div>\n\n"+((s=n["if"].call(o,t!=null?t.showBigSlider:t,{name:"if",hash:{},fn:e.program(13,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"},4:function(e,t,n,r,i){return"slideshowEnabled"},6:function(e,t,n,r,i){var s;return(s=e.invokePartial(r["context-slider-photo"],t,{name:"context-slider-photo",data:i,indent:"					",helpers:n,partials:r,decorators:e.decorators}))!=null?s:""},8:function(e,t,n,r,i){return'					<a class="context-thumb middle currentImage adThumb">Ad</a>\n'},10:function(e,t,n,r,i){var s;return(s=n.each.call(t!=null?t:{},t!=null?t.currentPhoto:t,{name:"each",hash:{},fn:e.program(11,i,0),inverse:e.noop,data:i}))!=null?s:""},11:function(e,t,n,r,i){var s;return(s=e.invokePartial(r["context-slider-photo"],t,{name:"context-slider-photo",data:i,indent:"						",helpers:n,partials:r,decorators:e.decorators}))!=null?s:""},13:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return"		<div class='context-slider big-slider "+((s=n["if"].call(o,t!=null?t.slideshowEnabled:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\'>\n\n			<span class="nav nav-l">\n				<span class="hide-text">&larr;</span>\n			</span>\n\n			<div class="wrapper clear-float">\n\n				<div class="slider">\n\n					'+a((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||u).call(o,t!=null?t.previousBigPhotos:t,{name:"renderTrustedMarkup",hash:{},data:i}))+"\n\n"+((s=n["if"].call(o,t!=null?t["is-ad"]:t,{name:"if",hash:{},fn:e.program(14,i,0),inverse:e.program(16,i,0),data:i}))!=null?s:"")+"\n					"+a((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||u).call(o,t!=null?t.nextBigPhotos:t,{name:"renderTrustedMarkup",hash:{},data:i}))+'\n\n				</div>\n\n			</div>\n\n			<span class="nav nav-r">\n				<span class="hide-text">&rarr;</span>\n			</span>\n\n		</div>\n'},14:function(e,t,n,r,i){return'						<a class="context-thumb middle currentImage adThumb">Ad</a>\n'},16:function(e,t,n,r,i){var s;return(s=n.each.call(t!=null?t:{},t!=null?t.currentPhoto:t,{name:"each",hash:{},fn:e.program(17,i,0),inverse:e.noop,data:i}))!=null?s:""},17:function(e,t,n,r,i){var s;return(s=e.invokePartial(r["context-slider-photo"],t,{name:"context-slider-photo",data:i,indent:"							",helpers:n,partials:r,decorators:e.decorators}))!=null?s:""},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.loadingError:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:""},usePartial:!0,useData:!0}),r={};e.Array.each(["context-slider-photo","context-slider-photo","context-slider-photo","context-slider-photo"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/context-slider-scrappy",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-context-slider-photo","hermes-template-context-slider-photo","hermes-template-context-slider-photo","hermes-template-context-slider-photo"]});
